{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///home/joet/Downloads/joetemulator/src/lib/constants.ts"],"sourcesContent":["// Shared constants for emulator systems and file extensions\n\nexport const FILE_EXTENSIONS: Record<string, string> = {\n  fds: \"nes\",\n  nes: \"nes\",\n  unif: \"nes\",\n  unf: \"nes\",\n  gb: \"gb\",\n  gbc: \"gbc\",\n  gba: \"gba\",\n  smc: \"snes\",\n  sfc: \"snes\",\n  swc: \"snes\",\n  vb: \"vb\",\n  vboy: \"vb\",\n  z64: \"n64\",\n  n64: \"n64\",\n  nds: \"nds\",\n  sms: \"segaMS\",\n  md: \"segaMD\",\n  gen: \"segaMD\",\n  smd: \"segaMD\",\n  gg: \"segaGG\",\n  \"32x\": \"sega32x\",\n  cso: \"psp\",\n  pbp: \"psp\",\n  a26: \"atari2600\",\n  a52: \"atari5200\",\n  a78: \"atari7800\",\n  lnx: \"lynx\",\n  j64: \"jaguar\",\n  jag: \"jaguar\",\n  d64: \"vice_x64\",\n  t64: \"vice_x64\",\n  tap: \"vice_x64\",\n  crt: \"vice_x64\",\n  col: \"coleco\",\n  cv: \"coleco\",\n  pce: \"pce\",\n  ngp: \"ngp\",\n  ngc: \"ngp\",\n  ws: \"ws\",\n  wsc: \"ws\"\n};\n\nexport const SYSTEM_PICKER: Record<string, Record<string, string>> = {\n  \"Nintendo\": {\n    \"NES\": \"nes\",\n    \"Game Boy\": \"gb\",\n    \"Game Boy Color\": \"gbc\",\n    \"Game Boy Advance\": \"gba\",\n    \"SNES\": \"snes\",\n    \"Virtual Boy\": \"vb\",\n    \"N64\": \"n64\",\n    \"DS\": \"nds\",\n  },\n  \"Sega\": {\n    \"Master System\": \"segaMS\",\n    \"Genesis/Mega Drive\": \"segaMD\",\n    \"Game Gear\": \"segaGG\",\n    \"CD\": \"segaCD\",\n    \"32X\": \"sega32x\",\n    \"Saturn\": \"segaSaturn\",\n  },\n  \"Sony\": {\n    \"PS1\": \"psx\",\n    \"PSP\": \"psp\",\n  },\n  \"Atari\": {\n    \"2600\": \"atari2600\",\n    \"5200\": \"atari5200\",\n    \"7800\": \"atari7800\",\n    \"Lynx\": \"lynx\",\n    \"Jaguar\": \"jaguar\",\n  },\n  \"Other\": {\n    \"Panasonic 3DO\": \"opera\",\n    \"Arcade (FBNeo)\": \"arcade\",\n    \"Arcade (M.A.M.E)\": \"mame2003_plus\",\n    \"Microsoft DOS\": \"dosbox_pure\",\n    \"Commodore PET\": \"vice_xpet\",\n    \"Commodore VIC-20\": \"vice_xvic\",\n    \"Commodore Amiga\": \"amiga\",\n    \"Commodore 64\": \"vice_x64\",\n    \"Commodore 128\": \"vice_x128\",\n    \"Commodore Plus/4\": \"vice_xplus4\",\n    \"ColecoVision\": \"coleco\",\n    \"NEC TurboGrafx-16\": \"pce\",\n    \"NEC PC-FX\": \"pcfx\",\n    \"SNK Neo Geo Pocket\": \"ngp\",\n    \"Bandai WonderSwan\": \"ws\"\n  }\n};\n\n// Flatten SYSTEM_PICKER for reverse lookups (core to system name)\nexport function getSystemNameByCore(core: string): string {\n  for (const category of Object.values(SYSTEM_PICKER)) {\n    for (const [name, systemCore] of Object.entries(category)) {\n      if (systemCore === core) {\n        return name;\n      }\n    }\n  }\n  return 'Unknown System';\n}\n\n// Create a flat version of SYSTEM_PICKER for backwards compatibility\nexport const SYSTEM_PICKER_FLAT: Record<string, string> = {};\nObject.values(SYSTEM_PICKER).forEach(category => {\n  Object.assign(SYSTEM_PICKER_FLAT, category);\n});\n\n"],"names":[],"mappings":"AAAA,4DAA4D;;;;;;;;;;;AAErD,MAAM,kBAA0C;IACrD,KAAK;IACL,KAAK;IACL,MAAM;IACN,KAAK;IACL,IAAI;IACJ,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,IAAI;IACJ,MAAM;IACN,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,IAAI;IACJ,KAAK;IACL,KAAK;IACL,IAAI;IACJ,OAAO;IACP,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,IAAI;IACJ,KAAK;IACL,KAAK;IACL,KAAK;IACL,IAAI;IACJ,KAAK;AACP;AAEO,MAAM,gBAAwD;IACnE,YAAY;QACV,OAAO;QACP,YAAY;QACZ,kBAAkB;QAClB,oBAAoB;QACpB,QAAQ;QACR,eAAe;QACf,OAAO;QACP,MAAM;IACR;IACA,QAAQ;QACN,iBAAiB;QACjB,sBAAsB;QACtB,aAAa;QACb,MAAM;QACN,OAAO;QACP,UAAU;IACZ;IACA,QAAQ;QACN,OAAO;QACP,OAAO;IACT;IACA,SAAS;QACP,QAAQ;QACR,QAAQ;QACR,QAAQ;QACR,QAAQ;QACR,UAAU;IACZ;IACA,SAAS;QACP,iBAAiB;QACjB,kBAAkB;QAClB,oBAAoB;QACpB,iBAAiB;QACjB,iBAAiB;QACjB,oBAAoB;QACpB,mBAAmB;QACnB,gBAAgB;QAChB,iBAAiB;QACjB,oBAAoB;QACpB,gBAAgB;QAChB,qBAAqB;QACrB,aAAa;QACb,sBAAsB;QACtB,qBAAqB;IACvB;AACF;AAGO,SAAS,oBAAoB,IAAY;IAC9C,KAAK,MAAM,YAAY,OAAO,MAAM,CAAC,eAAgB;QACnD,KAAK,MAAM,CAAC,MAAM,WAAW,IAAI,OAAO,OAAO,CAAC,UAAW;YACzD,IAAI,eAAe,MAAM;gBACvB,OAAO;YACT;QACF;IACF;IACA,OAAO;AACT;AAGO,MAAM,qBAA6C,CAAC;AAC3D,OAAO,MAAM,CAAC,eAAe,OAAO,CAAC,CAAA;IACnC,OAAO,MAAM,CAAC,oBAAoB;AACpC"}},
    {"offset": {"line": 137, "column": 0}, "map": {"version":3,"sources":["file:///home/joet/Downloads/joetemulator/src/lib/emulator.ts"],"sourcesContent":["import { FILE_EXTENSIONS, SYSTEM_PICKER_FLAT } from './constants';\n\nconst CDN_PATH = \"https://cdn.jsdelivr.net/gh/joethun/EmulatorJS-With-Cores/\";\n\ndeclare global {\n  interface Window {\n    gameRunning: boolean;\n    EJS_color: string;\n    EJS_backgroundColor: string;\n    EJS_player: string;\n    EJS_gameName: string;\n    EJS_gameUrl: File | string;\n    EJS_core: string;\n    EJS_pathtodata: string;\n    EJS_startOnLoaded: boolean;\n    EJS_biosUrl: string;\n    EJS_threads: boolean;\n    EJS_defaultOptions: Record<string, string>;\n    EJS_Buttons: Record<string, any>;\n    EJS_emulator?: any;\n    showSystemPicker?: (systems: Record<string, string>, callback: (core: string) => void) => void;\n    cleanupOldElements?: () => void;\n    hideMenu?: () => void;\n    createGameDisplay?: () => void;\n  }\n}\n\nif (typeof window !== 'undefined') {\n  window.gameRunning = false;\n}\n\nasync function detectCore(extension: string): Promise<string> {\n  if (FILE_EXTENSIONS[extension]) {\n    return FILE_EXTENSIONS[extension];\n  }\n  \n  // Fallback to NES if system picker not available\n  return new Promise((resolve) => {\n    if (typeof window !== 'undefined' && window.showSystemPicker) {\n      window.showSystemPicker(SYSTEM_PICKER_FLAT, resolve);\n    } else {\n      resolve(\"nes\");\n    }\n  });\n}\n\nfunction toggleMenuElements(show: boolean) {\n  if (typeof document === 'undefined') return;\n  \n  ['aside', 'footer', 'main', 'header'].forEach(selector => {\n    const element = document.querySelector(selector);\n    if (element) {\n      (element as HTMLElement).style.cssText = show \n        ? '' \n        : `display: none !important; visibility: hidden !important; z-index: -1 !important;`;\n    }\n  });\n  \n  const rootDiv = document.querySelector('div[style*=\"min-h-screen\"]');\n  if (rootDiv && !show) {\n    (rootDiv as HTMLElement).style.cssText += \" z-index: -1 !important;\";\n  }\n}\n\nfunction cleanupOldElements() {\n  const gameContainer = document.getElementById(\"game\");\n  if (gameContainer) {\n    gameContainer.innerHTML = \"\";\n    gameContainer.style.display = \"none\";\n  }\n  \n  // Remove old emulator scripts\n  const oldScripts = document.querySelectorAll('script[src*=\"loader.js\"]');\n  oldScripts.forEach(script => script.remove());\n  \n  // Restore menu visibility\n  toggleMenuElements(true);\n  \n  window.gameRunning = false;\n}\nfunction hideMenu() {\n  toggleMenuElements(false);\n}\n\nconst GAME_CONTAINER_STYLES = `\n  width: 100%;\n  height: 100vh;\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: 999999;\n  background-color: #000000;\n  overflow: hidden;\n  display: block !important;\n  visibility: visible !important;\n  opacity: 1 !important;\n`;\n\nfunction createGameDisplay() {\n  if (typeof document === 'undefined') return;\n  \n  let gameContainer = document.getElementById(\"game\");\n  if (!gameContainer) {\n    gameContainer = document.createElement(\"div\");\n    gameContainer.id = \"game\";\n    document.body.appendChild(gameContainer);\n  }\n  \n  gameContainer.innerHTML = \"\";\n  (gameContainer as HTMLElement).style.cssText = GAME_CONTAINER_STYLES;\n  \n  // Prevent scrolling\n  if (document.body) document.body.style.overflow = \"hidden\";\n  if (document.documentElement) document.documentElement.style.overflow = \"hidden\";\n}\n\nexport async function loadGame(file: File | string, coreOverride?: string, themeColor?: string): Promise<void> {\n  const fileName = file instanceof File ? file.name : file;\n  const fileExtension = fileName.split(\".\").pop()?.toLowerCase() || \"\";\n  const gameName = fileName.substring(0, fileName.lastIndexOf(\".\"));\n  \n  const core = coreOverride || await detectCore(fileExtension);\n  \n  cleanupOldElements();\n  hideMenu();\n  createGameDisplay();\n  if (typeof window !== 'undefined') {\n    window.gameRunning = true;\n  }\n  \n  configureEmulator(gameName, file, core, themeColor);\n  loadEmulatorScript();\n}\n\nfunction configureEmulator(gameName: string, gameFile: File | string, core: string, themeColor?: string) {\n  if (typeof window === 'undefined') return;\n  \n  window.EJS_color = themeColor || \"#003d8c\";\n  window.EJS_backgroundColor = \"#000000\";\n  window.EJS_player = \"#game\";\n  window.EJS_gameName = gameName;\n  window.EJS_gameUrl = gameFile;\n  window.EJS_core = core;\n  window.EJS_pathtodata = CDN_PATH;\n  window.EJS_startOnLoaded = true;\n  window.EJS_biosUrl = \"\";\n  \n  const threadsEnabled = [\"psp\", \"dosbox_pure\"];\n  if (threadsEnabled.includes(core)) {\n    window.EJS_threads = true;\n  }\n\n  window.EJS_defaultOptions = {\n    \"save-save-interval\": \"60\",\n    \"desmume_advanced_timing\": \"disabled\",\n    \"webgl2Enabled\": \"enabled\",\n    ...(core === \"segaGG\" && { retroarch_core: \"genesis_plus_gx\" }),\n    ...(core === \"nds\" && { retroarch_core: \"desmume\" })\n  };\n\n  window.EJS_Buttons = {\n    exitEmulation: false,\n    cacheManager: false,\n    saveSavFiles: { visible: false },\n    loadSavFiles: { visible: false }\n  };\n}\n\nfunction loadEmulatorScript() {\n  if (typeof document === 'undefined') return;\n  \n  const script = document.createElement(\"script\");\n  script.src = `${CDN_PATH}/loader.js`;\n  script.onload = () => {\n    setTimeout(() => {\n      const gameContainer = document.getElementById(\"game\");\n      if (gameContainer) {\n        (gameContainer as HTMLElement).style.cssText = GAME_CONTAINER_STYLES.replace(/\\n/g, ' ').replace(/\\s+/g, ' ').trim() + ' !important';\n        \n        const canvas = gameContainer.querySelector('canvas');\n        if (canvas) {\n          (canvas as HTMLElement).style.cssText = `\n            display: block !important;\n            visibility: visible !important;\n            opacity: 1 !important;\n            width: 100% !important;\n            height: 100% !important;\n          `;\n        }\n      }\n    }, 100);\n  };\n  document.body.appendChild(script);\n}\n\nfunction getEmulator() {\n  if (typeof window === 'undefined') return null;\n  return window.EJS_emulator?.started ? window.EJS_emulator : null;\n}\n\nexport async function saveState(): Promise<void> {\n  const emulator = getEmulator();\n  if (!emulator) return;\n\n  try {\n    const state = emulator.gameManager.getState();\n    const stateFileName = `${emulator.getBaseFileName()}.state`;\n    await emulator.storage.states.put(stateFileName, state);\n    emulator.displayMessage(\"SAVED STATE TO BROWSER\");\n  } catch (error: any) {\n    console.error(\"Save failed:\", error);\n    emulator.displayMessage(`Error saving: ${error.message}`);\n  }\n}\n\nexport async function loadState(): Promise<void> {\n  const emulator = getEmulator();\n  if (!emulator) return;\n\n  try {\n    const stateFileName = `${emulator.getBaseFileName()}.state`;\n    const state = await emulator.storage.states.get(stateFileName);\n    if (state) {\n      await emulator.gameManager.loadState(state);\n      emulator.displayMessage(\"LOADED STATE FROM BROWSER\");\n    } else {\n      emulator.displayMessage(\"\");\n    }\n  } catch (error: any) {\n    console.error(\"Load failed:\", error);\n    emulator.displayMessage(`Error loading: ${error.message}`);\n  }\n}\n\nexport function exitGame() {\n  cleanupOldElements();\n  const gameContainer = document.getElementById(\"game\");\n  if (gameContainer) {\n    gameContainer.style.display = \"none\";\n  }\n}\n\nexport function addEventListeners() {\n  if (typeof document === 'undefined') return;\n  \n  document.addEventListener(\"keydown\", (event) => {\n    if (event.key === \"F1\") {\n      event.preventDefault();\n      saveState();\n    } else if (event.key === \"F2\") {\n      event.preventDefault();\n      loadState();\n    } else if (event.key === \"Escape\" && window.gameRunning) {\n      event.preventDefault();\n      exitGame();\n    }\n  });\n}\n\n// Expose functions to window for global access\nif (typeof window !== 'undefined') {\n  window.cleanupOldElements = cleanupOldElements;\n  window.hideMenu = hideMenu;\n  window.createGameDisplay = createGameDisplay;\n}\n\n// Initialize event listeners when DOM is ready\nif (typeof document !== 'undefined') {\n  if (document.readyState === 'loading') {\n    document.addEventListener(\"DOMContentLoaded\", addEventListeners);\n  } else {\n    addEventListeners();\n  }\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 343, "column": 0}, "map": {"version":3,"sources":["file:///home/joet/Downloads/joetemulator/src/lib/storage.ts"],"sourcesContent":["// IndexedDB storage for large game files\n\nconst DB_NAME = 'joetemulator';\nconst DB_VERSION = 1;\nconst STORE_NAME = 'gameFiles';\n\nlet db: IDBDatabase | null = null;\n\nfunction openDB(): Promise<IDBDatabase> {\n  return new Promise((resolve, reject) => {\n    if (typeof window === 'undefined' || !window.indexedDB) {\n      reject(new Error('IndexedDB not supported'));\n      return;\n    }\n\n    if (db) {\n      resolve(db);\n      return;\n    }\n\n    const request = indexedDB.open(DB_NAME, DB_VERSION);\n\n    request.onerror = () => reject(request.error);\n    request.onsuccess = () => {\n      db = request.result;\n      resolve(db);\n    };\n\n    request.onupgradeneeded = (event) => {\n      const database = (event.target as IDBOpenDBRequest).result;\n      if (!database.objectStoreNames.contains(STORE_NAME)) {\n        database.createObjectStore(STORE_NAME);\n      }\n    };\n  });\n}\n\nasync function executeStoreOperation<T>(\n  mode: IDBTransactionMode,\n  operation: (store: IDBObjectStore) => IDBRequest<T>\n): Promise<T> {\n  const database = await openDB();\n  return new Promise((resolve, reject) => {\n    const transaction = database.transaction([STORE_NAME], mode);\n    const store = transaction.objectStore(STORE_NAME);\n    const request = operation(store);\n    \n    request.onerror = () => reject(request.error);\n    request.onsuccess = () => resolve(request.result);\n  });\n}\n\nexport async function saveGameFile(gameId: number, file: File): Promise<void> {\n  await executeStoreOperation('readwrite', (store) => store.put(file, gameId));\n}\n\nexport async function getGameFile(gameId: number): Promise<File | null> {\n  const result = await executeStoreOperation('readonly', (store) => store.get(gameId));\n  return result || null;\n}\n\nexport async function deleteGameFile(gameId: number): Promise<void> {\n  await executeStoreOperation('readwrite', (store) => store.delete(gameId));\n}\n\n"],"names":[],"mappings":"AAAA,yCAAyC;;;;;;;;;AAEzC,MAAM,UAAU;AAChB,MAAM,aAAa;AACnB,MAAM,aAAa;AAEnB,IAAI,KAAyB;AAE7B,SAAS;IACP,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,wCAAwD;YACtD,OAAO,IAAI,MAAM;YACjB;QACF;;;QAOA,MAAM;IAcR;AACF;AAEA,eAAe,sBACb,IAAwB,EACxB,SAAmD;IAEnD,MAAM,WAAW,MAAM;IACvB,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,MAAM,cAAc,SAAS,WAAW,CAAC;YAAC;SAAW,EAAE;QACvD,MAAM,QAAQ,YAAY,WAAW,CAAC;QACtC,MAAM,UAAU,UAAU;QAE1B,QAAQ,OAAO,GAAG,IAAM,OAAO,QAAQ,KAAK;QAC5C,QAAQ,SAAS,GAAG,IAAM,QAAQ,QAAQ,MAAM;IAClD;AACF;AAEO,eAAe,aAAa,MAAc,EAAE,IAAU;IAC3D,MAAM,sBAAsB,aAAa,CAAC,QAAU,MAAM,GAAG,CAAC,MAAM;AACtE;AAEO,eAAe,YAAY,MAAc;IAC9C,MAAM,SAAS,MAAM,sBAAsB,YAAY,CAAC,QAAU,MAAM,GAAG,CAAC;IAC5E,OAAO,UAAU;AACnB;AAEO,eAAe,eAAe,MAAc;IACjD,MAAM,sBAAsB,aAAa,CAAC,QAAU,MAAM,MAAM,CAAC;AACnE"}}]
}